# Gemini Canvas Slides Generation Prompt
# 排球分析系統優化技術簡報生成提示詞

請使用以下內容生成一個專業的技術簡報，包含多個幻燈片，詳細介紹排球分析系統的三個核心優化技術。

---

## 簡報主題
**排球AI分析系統：核心技術優化與實現**

## 簡報結構要求
請創建一個包含以下部分的專業簡報：

### 第1張：封面頁
- 標題：排球AI分析系統：核心技術優化與實現
- 副標題：Player Action Detection | Ball Tracking | Jersey Number Recognition
- 日期：2025年12月
- 設計風格：現代、專業、運動風格

---

### 第2張：系統架構總覽
**標題：系統架構總覽**

內容：
- 展示三個核心模組的關係圖
- **Player Action Detection**（動作識別）
- **Ball Tracking**（球追蹤）
- **Jersey Number Detection**（球衣號碼識別）
- 使用流程圖展示：Video Input → Detection → Tracking → Analysis → Results

視覺元素：
- 使用流程圖或架構圖
- 三個模組用不同顏色標示
- 箭頭顯示數據流向

---

### 第3-5張：Player Action Detection 優化技術

#### 第3張：動作檢測模型架構
**標題：Player Action Detection - 模型架構**

內容：
- **模型選擇**：YOLOv11m (Medium variant)
- **數據集**：24,806 張圖片（訓練集 18,616 / 驗證集 3,636 / 測試集 2,554）
- **輸入尺寸**：640×640 pixels
- **檢測類別**：5種動作（Serve, Receive, Set, Spike, Block）
- **置信度閾值**：0.6（過濾低置信度檢測）

技術細節：
- Optimizer: SGD (learning rate 0.001)
- Batch Size: 12-20
- Epochs: 200 with early stopping
- Data Augmentation: Mosaic, MixUp, RandomHSV

視覺元素：
- YOLOv11 架構圖
- 動作類別圖標
- 性能指標（mAP@0.5: 94.49%）

---

#### 第4張：動作合併與追蹤機制
**標題：動作合併與追蹤機制**

內容：
- **問題**：單幀檢測會產生大量重複動作
- **解決方案**：時序動作合併算法

**核心參數**：
- `MIN_ACTION_FRAMES = 3`：最小動作持續時間（過濾短暫誤檢測）
- `MAX_GAP_FRAMES = 5`：最大間隔幀數（超過此幀數認為動作結束）

**合併邏輯**：
1. 連續檢測到相同動作時，延長結束時間
2. 更新最大置信度和最新 bbox
3. 超過最大間隔幀數時，完成動作並保存
4. 只有持續時間 >= 3 幀的動作才會被保存

**動作與球員關聯**：
- 使用 IOU（Intersection over Union）匹配
- IOU 閾值：0.05
- 距離備選：如果 IOU 低但距離 < 動作框對角線的 1.5 倍，也認為匹配

視覺元素：
- 時序圖展示動作合併過程
- 代碼流程圖
- 動作持續時間統計圖

---

#### 第5張：動作檢測性能指標
**標題：動作檢測性能指標**

內容：
- **整體檢測率**：94.49% mAP@0.5（所有動作類別）
- **實時性能**：7.91 FPS（每幀 90-95ms）
- **測試視頻動作分布**：
  - Block: 110 次
  - Spike: 72 次
  - Set: 48 次
  - Receive: 25 次
  - Serve: 20 次
- **改進效果**：相比 YOLOv8 baseline，檢測數量提升 +37.1%

視覺元素：
- 動作分布柱狀圖
- 性能對比圖表
- 檢測準確率餅圖

---

### 第6-8張：Ball Tracking 優化技術

#### 第6張：雙模型檢測策略
**標題：Ball Tracking - 雙模型檢測策略**

內容：
- **主要模型**：VballNet ONNX（9幀序列模型）
  - 使用 9 幀時序緩衝區提升檢測準確率
  - 輸入：288×512 灰度圖
  - 輸出：熱力圖（heatmap）
  - 閾值：0.3（降低閾值以提高檢測率）
  - 後處理：輪廓檢測 + 質心計算

- **備選模型**：YOLO Sports Ball Detection
  - 當 VballNet 失敗時自動切換
  - COCO class 32（sports ball）
  - 置信度閾值：0.15

**優點**：
- 提高檢測覆蓋率
- 容錯機制確保穩定性
- 結合時序信息和單幀檢測

視覺元素：
- 雙模型架構圖
- 9幀緩衝區示意圖
- 檢測流程圖

---

#### 第7張：三階段軌跡過濾管道
**標題：三階段軌跡過濾管道**

內容：
- **Stage 1: 基本速度過濾** (`_basic_velocity_filter`)
  - 移除速度過快的異常點
  - 最大速度：3000 px/s（排球最快可達 100 km/h）
  - 最小置信度：0.15

- **Stage 2: 物理模型異常點移除** (`_physics_based_outlier_removal`)
  - 使用滑動窗口（7點）進行局部拋物線擬合
  - X 座標：線性擬合（x(t) = x0 + vx * t）
  - Y 座標：二次擬合（y(t) = y0 + vy * t + 0.5 * g * t²）
  - 動態閾值：中位數偏差 × 2.5
  - 過度過濾保護：移除超過 50% 點時回退到原始數據

- **Stage 3: 高斯加權平滑** (`_smooth_ball_trajectory`)
  - 窗口大小：5 幀
  - 使用高斯權重平滑軌跡
  - 同步更新 bbox 位置

視覺元素：
- 三階段處理流程圖
- 過濾前後軌跡對比圖
- 拋物線擬合示意圖

---

#### 第8張：缺失幀插值與性能
**標題：缺失幀插值與性能**

內容：
- **二次（拋物線）插值** (`_interpolate_missing_frames`)
  - 使用 3 點擬合拋物線（更符合物理運動）
  - 最大插值間隔：15 幀
  - 線性插值備選：當點數不足時回退

**處理統計**：
- 原始檢測點數 → 移除異常點 → 插值缺失幀 → 最終軌跡
- 示例：原始 1000 點 → 移除 150 異常點 → 插值 200 點 → 最終 1050 點

**性能指標**：
- F1-Score: 0.874 (87.4%)
- Precision: 0.882, Recall: 0.867
- 處理速度：最高 200 FPS（CPU）
- 檢測率：80.7% 成功檢測

視覺元素：
- 插值前後軌跡對比
- 處理統計圖表
- 性能指標儀表盤

---

### 第9-11張：Jersey Number Detection 優化技術

#### 第9張：雙模型 OCR 策略
**標題：Jersey Number Detection - 雙模型 OCR 策略**

內容：
- **優先模型**：YOLOv8 Jersey Number Detection
  - 專門訓練的球衣號碼檢測模型
  - 檢測數字 0-9
  - 置信度閾值：0.15
  - IOU 閾值：0.4

- **備選模型**：EasyOCR
  - 當 YOLO 模型失敗時自動降級
  - 通用 OCR 引擎
  - 支持英文數字識別

**多角度檢測**：
- **前胸區域**：上半身 60%（權重 1.0）
- **後背區域**：上半身 10%-70%（權重 1.2，因為背號通常更大更清晰）
- 從多區域結果中選擇置信度最高的

視覺元素：
- 雙模型架構圖
- 多角度 ROI 區域示意圖
- 檢測流程圖

---

#### 第10張：圖像預處理與數字合併
**標題：圖像預處理與數字合併**

內容：
- **圖像預處理** (`_preprocess_roi`)
  1. 轉換為灰度圖
  2. CLAHE（對比度限制自適應直方圖均衡化）
     - clipLimit: 2.0
     - tileGridSize: 8×8
  3. 銳化濾波器（3×3 核）
  4. 轉換回 BGR 格式（EasyOCR 需要）

- **數字合併邏輯** (`_merge_digit_detections`)
  - 按 X 座標排序（從左到右）
  - 過濾低置信度檢測（>= 0.15）
  - 單數字：直接返回（1-9）
  - 兩位數：檢查數字間距（< 平均寬度 × 3）
  - 合併規則：tens × 10 + ones（範圍 1-99）

**檢測頻率優化**：
- 每 5 幀檢測一次（從每 10 幀改進）
- 性能與準確率平衡

視覺元素：
- 預處理前後對比圖
- 數字合併流程圖
- ROI 提取示意圖

---

#### 第11張：多幀融合與穩定 ID
**標題：多幀融合與穩定 ID**

內容：
- **多幀融合機制**：
  - 記錄每個 track_id 的歷史檢測結果（最多 50 次）
  - 使用投票機制：選擇最常見的號碼
  - 閾值：至少出現 1 次（YOLO）或 2 次（EasyOCR）

- **穩定 ID 映射**：
  - `stable_id`：基於球衣號碼的穩定標識
  - `track_id`：Norfair 追蹤器的臨時 ID
  - 當檢測到相同球衣號碼時，即使 track_id 改變，也使用相同的 stable_id
  - 改善追蹤穩定性：減少 ID 切換問題

**追蹤穩定性優化**：
- 球衣號碼 → 穩定 ID 映射表
- 多個 track_id 可以映射到同一個 stable_id
- 歷史記錄檢查：即使當前幀未檢測，也使用歷史記錄

視覺元素：
- 多幀融合流程圖
- track_id 與 stable_id 映射關係圖
- 投票機制示意圖

---

### 第12張：整合優化效果總結
**標題：整合優化效果總結**

內容：
- **Player Action Detection**
  - mAP@0.5: 94.49%
  - 檢測數量提升：+37.1%（相比 YOLOv8）
  - 實時性能：7.91 FPS

- **Ball Tracking**
  - F1-Score: 0.874 (87.4%)
  - 檢測率：80.7%
  - 處理速度：最高 200 FPS

- **Jersey Number Detection**
  - 多角度檢測提升準確率
  - 多幀融合減少誤識別
  - 穩定 ID 映射改善追蹤

**整體系統性能**：
- 端到端處理速度：實時分析能力
- 準確率：各模組均達到 80%+ 準確率
- 穩定性：多層容錯機制確保系統穩定運行

視覺元素：
- 三個模組的性能對比圖表
- 整體架構圖
- 優化效果總結表格

---

### 第13張：技術創新點
**標題：技術創新點**

內容：
1. **時序動作合併算法**
   - 解決單幀檢測重複問題
   - 提高動作識別準確率

2. **三階段軌跡過濾管道**
   - 結合速度、物理模型、平滑處理
   - 有效過濾誤檢測

3. **雙模型容錯機制**
   - 主要模型 + 備選模型
   - 提高系統穩定性

4. **多角度 OCR 檢測**
   - 前胸 + 後背區域檢測
   - 多幀融合投票機制

5. **穩定 ID 映射**
   - 基於球衣號碼的穩定標識
   - 改善追蹤穩定性

視覺元素：
- 創新點列表
- 技術優勢對比
- 應用場景示意圖

---

### 第14張：未來優化方向
**標題：未來優化方向**

內容：
- **Player Action Detection**
  - 引入時序模型（LSTM/Transformer）
  - 動作序列分析
  - 動作質量評估

- **Ball Tracking**
  - Kalman Filter 預測追蹤
  - 球場幾何約束
  - 球員位置輔助追蹤

- **Jersey Number Detection**
  - 姿態估計引導 ROI 裁剪
  - 更先進的 OCR 模型（PARSeq）
  - 可讀性分類器

視覺元素：
- 優化路線圖
- 技術發展方向
- 預期效果指標

---

### 第15張：結論
**標題：結論**

內容：
- 成功實現三個核心模組的優化
- 各模組性能達到實用水平（80%+ 準確率）
- 系統穩定性和實時性能優秀
- 為排球比賽分析提供可靠的技術基礎

視覺元素：
- 系統整體架構
- 應用場景展示
- 感謝頁面

---

## 設計要求

### 視覺風格
- **配色方案**：運動風格（藍色、橙色、白色）
- **字體**：清晰易讀的無襯線字體
- **圖表**：使用專業的數據可視化圖表
- **圖標**：使用相關的運動圖標和技術圖標

### 每張幻燈片要求
- 標題清晰醒目
- 內容結構化（使用項目符號、編號列表）
- 關鍵數據突出顯示（使用不同顏色或加粗）
- 適當使用圖表、流程圖、架構圖
- 保持一致的設計風格

### 技術細節
- 代碼片段使用等寬字體
- 參數和數值使用高亮顯示
- 流程圖使用標準符號（矩形=處理，菱形=判斷，圓形=開始/結束）

---

## 生成指令

請根據以上內容生成一個完整的技術簡報，包含：
1. 15 張專業幻燈片
2. 每張幻燈片包含標題、內容、視覺元素描述
3. 統一的設計風格
4. 清晰的技術說明和數據展示

請確保簡報：
- 專業且易於理解
- 視覺效果良好
- 技術內容準確
- 適合技術演講或學術報告

---

## 補充說明

### 關鍵技術參數總結

**Player Action Detection:**
- Model: YOLOv11m
- Confidence Threshold: 0.6
- MIN_ACTION_FRAMES: 3
- MAX_GAP_FRAMES: 5
- mAP@0.5: 94.49%

**Ball Tracking:**
- Primary Model: VballNet ONNX (9-frame sequence)
- Fallback Model: YOLO Sports Ball
- Max Velocity: 3000 px/s
- Window Size: 7 (physics), 5 (smoothing)
- Max Interpolation Gap: 15 frames
- F1-Score: 0.874

**Jersey Number Detection:**
- Primary Model: YOLOv8 Jersey Number
- Fallback Model: EasyOCR
- Detection Frequency: Every 5 frames
- Multi-frame Fusion: 50 history, voting mechanism
- ROI: Front (60% height, weight 1.0) + Back (10-70% height, weight 1.2)
- Preprocessing: CLAHE + Sharpening

### 性能指標

| 模組 | 準確率 | 處理速度 | 改進效果 |
|------|--------|----------|----------|
| Action Detection | 94.49% mAP | 7.91 FPS | +37.1% vs YOLOv8 |
| Ball Tracking | 87.4% F1 | 200 FPS | 80.7% detection rate |
| Jersey Number | Multi-frame fusion | Real-time | Stable ID mapping |

---

## 使用說明

1. 複製整個提示詞內容
2. 打開 Google Gemini（或 Gemini Canvas）
3. 貼上提示詞並發送
4. Gemini 將根據提示詞生成完整的技術簡報
5. 可以根據需要調整設計風格或內容

---

**最後更新**: 2025年12月

